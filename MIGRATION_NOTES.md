# –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ –≤ app/

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
```
shpak-k8s/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (env.py, ports.json)
‚îÇ   ‚îú‚îÄ‚îÄ core/            # –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (mhe_*.py)
‚îÇ   ‚îú‚îÄ‚îÄ models/          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Pydantic)
‚îÇ   ‚îî‚îÄ‚îÄ routers/         # API —Ä–æ—É—Ç–µ—Ä—ã (FastAPI)
‚îú‚îÄ‚îÄ docker/
‚îú‚îÄ‚îÄ k8s-manifests/
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:

1. **–í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã** (19 –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ 11 —Ñ–∞–π–ª–∞—Ö):
   - `from config.env import st` ‚Üí `from app.config.env import st`
   - `from models.X import Y` ‚Üí `from app.models.X import Y`
   - `from routers.X import Y` ‚Üí `from app.routers.X import Y`

2. **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –æ–±–Ω–æ–≤–ª–µ–Ω—ã** (2 —Ñ–∞–π–ª–∞):
   - `config/ports.json` ‚Üí `app/config/ports.json`
   - –§–∞–π–ª—ã: `mhe_ae.py`, `mhe_app.py`

3. **Dockerfile –æ–±–Ω–æ–≤–ª–µ–Ω**:
   - –û–±—ä–µ–¥–∏–Ω–µ–Ω—ã 4 `COPY` –∫–æ–º–∞–Ω–¥—ã –≤ –æ–¥–Ω—É: `COPY app/ /opt/app/app/`

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤:

**–î–æ –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
python core/mhe_db.py
python core/mhe_app.py
```

**–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
python -m app.core.mhe_db
python -m app.core.mhe_app
python -m app.core.mhe_ae
python -m app.core.mhe_fortiapi
python -m app.core.mhe_email
python -m app.core.mhe_radius
python -m app.core.mhe_log
python -m app.core.mhe_ldap
```

### Docker:
```bash
# Build –æ–±—Ä–∞–∑
docker build -f docker/Dockerfile -t shpak-k8s:latest .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker run --rm -p 80:80 shpak-k8s:latest python -m app.core.mhe_db
docker run --rm -p 80:80 shpak-k8s:latest python -m app.core.mhe_app
docker run --rm -p 80:80 shpak-k8s:latest python -m app.core.mhe_ae

# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (PowerShell)
./docker/test_build.ps1

# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (Bash)
bash docker/test_build.sh
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:**
```
/opt/app/              ‚Üê WORKDIR
‚îú‚îÄ‚îÄ app/               ‚Üê –í–∞—à –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îî‚îÄ‚îÄ requirements.txt
```

### Kubernetes:
–ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Docker –æ–±—Ä–∞–∑.

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:

- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã
- ‚úÖ __init__.py —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã (4 —Ñ–∞–π–ª–∞)
- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ core/ (8 —Ñ–∞–π–ª–æ–≤)
- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ routers/ (4 —Ñ–∞–π–ª–∞)
- ‚úÖ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (2 —Ñ–∞–π–ª–∞)
- ‚úÖ Dockerfile –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ –°—Ç–∞—Ä—ã–µ –ø–∞–ø–∫–∏ —É–¥–∞–ª–µ–Ω—ã

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

1. **PYTHONPATH**: –í Docker `/opt/app` —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π, –ø–æ—ç—Ç–æ–º—É –∏–º–ø–æ—Ä—Ç—ã `from app.` —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

2. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ª–æ–∫–∞–ª—å–Ω–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ `shpak-k8s/`.

3. **–¢–µ—Å—Ç—ã**: –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–µ—Å—Ç—ã, –∏—Ö –∏–º–ø–æ—Ä—Ç—ã —Ç–æ–∂–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞ `from app.X import Y`.

4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–µ –∏–º–ø–æ—Ä—Ç—ã (`from config.env`) –±–æ–ª—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç - –≤—Å–µ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ (`from app.config.env`).

## üîÑ –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ git:
```bash
git checkout HEAD -- .
git clean -fd
```

---

**–î–∞—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–∏**: 2025-10-20  
**–í–µ—Ä—Å–∏—è Python**: 3.11+  
**FastAPI —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: ‚úÖ –ü–æ–ª–Ω–∞—è

